name: Slim release
on:
  pull_request:
    branches:
      - main

jobs:
  run:
    runs-on: ubuntu-24.04
    defaults:
      run:
        shell: bash
    env:
      SIZE_LIMIT: 524288  # 512KB in bytes
      SLIM_SUFFIX: "-slim"
      BASE_RELEASE: "release-1.5.0"
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          ref: ${{ env.BASE_RELEASE }}

      - name: Check if slim tag exists
        id: check_slim_release
        run: |
          git ls-remote --exit-code --tags origin "${{ env.BASE_RELEASE }}${{ env.SLIM_SUFFIX }}" >/dev/null 2>&1
          if [ $? -eq 0 ]; then
            echo "exists=true" >> "$GITHUB_OUTPUT"
            echo "Slim tag ${{ env.BASE_RELEASE }}${{ env.SLIM_SUFFIX }} already exists"
          else
            echo "exists=false" >> "$GITHUB_OUTPUT"
            echo "Slim tag ${{ env.BASE_RELEASE }}${{ env.SLIM_SUFFIX }} does not exist"
          fi
      
      
