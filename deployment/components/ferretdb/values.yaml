# Copyright (C) 2024-2026 Intel Corporation
# SPDX-License-Identifier: Apache-2.0

# FerretDB Configuration
ferretdb:
  image:
    repository: "ghcr.io/ferretdb/ferretdb"
    tag: "2.5.0"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 27017
    targetPort: 27017

# PostgreSQL Backend Configuration with DocumentDB extension
postgresql:
  image:
    repository: "ghcr.io/ferretdb/postgres-documentdb"
    tag: "17-0.106.0-ferretdb-2.5.0"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 5432
    targetPort: 5432
  auth:
    enabled: true
    database: "postgres"
    username: "usr"
    password: ""  # Will be generated
  persistence:
    enabled: true
    size: "8Gi"
    storageClass: ""

# Common Configuration
nameOverride: ""
fullnameOverride: ""

# Security Contexts (PSS compliant)
securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  runAsGroup: 3000
  fsGroup: 2000
  seccompProfile:
    type: RuntimeDefault

containerSecurityContext:
  capabilities:
    drop:
      - ALL
  runAsNonRoot: true
  allowPrivilegeEscalation: false

# Resources
resources:
  ferretdb:
    requests:
      memory: "64Mi"
      cpu: "250m"
    limits:
      memory: "512Mi"
      cpu: 1
  postgresql:
    requests:
      memory: "256Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: 1

nodeSelector: {}
tolerations: []
affinity: {}
