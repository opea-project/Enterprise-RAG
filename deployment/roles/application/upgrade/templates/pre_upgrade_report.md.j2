# Pre-Upgrade Assessment Report

**Generated:** {{ ansible_date_time.iso8601 }}  
**Upgrade Target:** {{ upgrade_target | default('N/A') }}

---

# Metadata Check Report

**Generated:** {{ ansible_date_time.iso8601 }}  
**Status:** {{ metadata_verification_result.status | upper }}

---

## Executive Summary

- **Total Validations:** {{ metadata_verification_result.total_validations }}
- **Approved Changes:** {{ metadata_verification_result.approved_count }}
- **Mitigated Changes:** {{ metadata_verification_result.mitigated_count }}
- **Rejected Changes:** {{ metadata_verification_result.rejected_count }}
- **Mitigations Required:** {{ metadata_verification_result.mitigations_required }}
- **Mitigations Applied:** {{ metadata_verification_result.mitigations_applied }}
- **Mitigations Pending:** {{ metadata_verification_result.mitigations_pending }}

---

## Component Summary

{% for component in metadata_validations | map(attribute='component') | unique | sort %}
### {{ component }}

{% set component_validations = metadata_validations | selectattr('component', 'equalto', component) | list %}
- **Total Changes:** {{ component_validations | length }}
- **Approved:** {{ component_validations | selectattr('response', 'equalto', 'approve') | list | length }}
- **Mitigated:** {{ component_validations | selectattr('response', 'equalto', 'mitigate') | list | length }}
- **Rejected:** {{ component_validations | selectattr('response', 'equalto', 'reject') | list | length }}

{% endfor %}

---

## Conclusion

{% if metadata_verification_result.rejected_count > 0 %}
❌ **Metadata verification REJECTED.**

There are {{ metadata_verification_result.rejected_count }} rejected change(s) that require manual review and cannot proceed.

**Action Required:** Review and address all rejected changes before proceeding with the upgrade.

For detailed information about specific rejected changes, see the [Metadata Check Report](02_metadata-check.md).

{% elif metadata_verification_result.status == 'failed' %}
❌ **Metadata verification failed.**

{% if metadata_verification_result.mitigations_pending > 0 %}
There are {{ metadata_verification_result.mitigations_pending }} pending mitigation(s) that must be addressed before proceeding.
{% endif %}

**Action Required:** Review and address all issues before proceeding with the upgrade.

For detailed information, see the [Metadata Check Report](02_metadata-check.md).

{% else %}
✅ **All metadata changes have been validated successfully.**

{% if metadata_verification_result.mitigated_count > 0 %}
All required mitigations have been applied and verified.
{% endif %}

The upgrade can proceed.

For detailed information, see the [Metadata Check Report](02_metadata-check.md).

{% endif %}