# Copyright (C) 2024-2025 Intel Corporation
# SPDX-License-Identifier: Apache-2.0

---
- name: Gaudi operator role
  when: gaudi_operator
  ansible.builtin.include_role:
    name: gaudi_operator
  tags:
    - install
    - post-install
    - delete

- name: NFS Server CSI role
  when: install_csi == "nfs"
  ansible.builtin.include_role:
    name: nfs_server_csi_setup
  tags:
    - install
    - post-install

- name: Velero role
  when: velero.enabled
  ansible.builtin.include_role:
    name: velero
  vars:
    deployment_dir: "{{ playbook_dir }}/.."
    log_dir: "{{ deployment_dir }}/ansible-logs"
    tmp_dir: "{{ deployment_dir }}/velero-tmp"
  tags:
    - install
    - post-install
    - delete
    - velero-delete

- name: Uninstall NFS Server
  when: install_csi == "nfs"
  ansible.builtin.include_role:
    name: nfs_server_csi_setup
  tags:
    - delete
