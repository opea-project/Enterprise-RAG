# Copyright (C) 2024-2025 Intel Corporation
# SPDX-License-Identifier: Apache-2.0

---
- name: Ensure pipelines variable is defined
  ansible.builtin.set_fact:
    pipelines: "{{ pipelines | default([]) }}"
  tags:
    - install

- name: Get namespace for all pipelines
  ansible.builtin.set_fact:
    pipeline_namespaces: "{{ pipelines | selectattr('namespace', 'defined') | map(attribute='namespace') | list }}"
  tags:
    - install

- name: Fail if no pipeline namespaces are found
  ansible.builtin.fail:
    msg: "No namespaces found for all pipelines"
  when: pipeline_namespaces is not defined or pipeline_namespaces | length == 0
  tags:
    - install
