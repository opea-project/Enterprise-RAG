From 349af47f24e5780378817e5893d44ddcbd7fcf2a Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Micha=C5=82=20Prostko?= <michal.prostko@intel.com>
Date: Wed, 4 Jun 2025 12:53:15 +0000
Subject: [PATCH] additional missing update for AsyncRedisCluster patch

---
 redisvl/redis/connection.py | 56 +++++-
 1 file changed, 5 insertions(+), 1 deletions(-)

diff --git a/redisvl/redis/connection.py b/redisvl/redis/connection.py
index 5ec562d0..a4a94738 100644
--- a/redisvl/redis/connection.py
+++ b/redisvl/redis/connection.py
@@ -327,7 +369,11 @@ def get_async_redis_connection(
             DeprecationWarning,
         )
         url = url or get_address_from_env()
-        return AsyncRedis.from_url(url, **kwargs)
+        if is_cluster_url(url, **kwargs):
+          clean_url, clean_kwargs = _strip_cluster_from_url_and_kwargs(url, **kwargs)
+          return AsyncRedisCluster.from_url(clean_url, **clean_kwargs)
+        else:
+          return AsyncRedis.from_url(url, **kwargs)
 
     @staticmethod
     def get_redis_cluster_connection(
